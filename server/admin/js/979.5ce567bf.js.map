{"version":3,"file":"js/979.5ce567bf.js","mappings":"8KAGO,MAAMA,EAAYC,EAAAA,EAAAA,SAAAA,QAAwB,UAGpCC,EAAiB,CAC1BC,cAAgB,UAASC,aAAaC,OAAS,K,mOCyCzC,MAAEC,IAAUC,EAAAA,EAAAA,MAEZC,GAASC,EAAAA,EAAAA,MAGTC,GAAOC,EAAAA,EAAAA,IAAS,CAClBC,MAAO,KASLC,EAASC,IACXR,EAAMS,MAAMC,IAAK,YAAWF,KAAMG,MAAMC,IACpCR,EAAKS,KAAOD,EAAIE,KAAKD,KACrBT,EAAKE,MAAQM,EAAIE,KAAKR,KAAK,GAC7B,EAIAS,EAAW,KACTC,EAAMR,GACNR,EAAMS,MAAMQ,IAAK,YAAWD,EAAMR,KAAMJ,GAAMO,MAAK,KAC/CT,EAAOgB,KAAK,cACZC,EAAAA,EAAAA,IAAU,CACNC,QAAS,OACTC,KAAM,WACR,IAGNrB,EAAMS,MAAMa,KAAK,WAAYlB,GAAMO,MAAK,KACpCT,EAAOgB,KAAK,cACZC,EAAAA,EAAAA,IAAU,CACNC,QAAS,OACTC,KAAM,WACR,GAEV,E,OAIJL,EAAMR,IAAMD,EAAMS,EAAMR,I,8/DCvF5B,MAAMe,EAAc,EAEpB,O","sources":["webpack://admin/./src/upload.js","webpack://admin/./src/views/AdEdit.vue","webpack://admin/./src/views/AdEdit.vue?2838"],"sourcesContent":["import http from './http'\r\n\r\n// upload地址\r\nexport const uploadUrl = http.defaults.baseURL + '/upload'\r\n\r\n// upload用户登录验证\r\nexport const getAuthHeaders = {\r\n    Authorization: `Bearer ${localStorage.token || ''}`\r\n}","<template>\r\n    <div>\r\n        <h1>{{ props.id ? '编辑' : '新建' }}广告位</h1>\r\n        <el-form :model=\"form\" label-width=\"200px\">\r\n            <el-form-item label=\"名称\">\r\n                <el-input v-model=\"form.name\" />\r\n            </el-form-item>\r\n            <el-form-item label=\"广告\">\r\n                <el-button @click=\"form.items.push({})\"><el-icon><Plus /></el-icon>添加广告</el-button>\r\n                <el-col>\r\n                    <el-row type=\"flex\" style=\"flex-wrap: wrap;\">\r\n                        <el-col :md=\"12\" v-for=\"(item, i) in form.items\" :key=\"i\">\r\n                            <el-form-item label=\"跳转链接（URL）\">\r\n                                <el-input v-model=\"item.url\" /> \r\n                            </el-form-item>\r\n                            <el-form-item label=\"图片\" style=\"margin-top: 10px;\">\r\n                                <el-upload\r\n                                    class=\"avatar-uploader\"\r\n                                    :action=\"uploadUrl\"\r\n                                    :headers=\"getAuthHeaders\"\r\n                                    :show-file-list=\"false\"\r\n                                    :on-success=\"res => item.image = res.url\"\r\n                                >\r\n                                    <img v-if=\"item.image\" :src=\"item.image\" class=\"avatar\" />\r\n                                    <el-icon v-else class=\"avatar-uploader-icon\"><Plus /></el-icon>\r\n                                </el-upload>\r\n                            </el-form-item>\r\n                            <el-form-item>\r\n                                <el-button size=\"small\" type=\"danger\" @click=\"form.items.splice(i, 1)\">删除</el-button>\r\n                            </el-form-item>\r\n                        </el-col>\r\n                    </el-row>\r\n                </el-col>\r\n            </el-form-item>\r\n            <el-form-item>\r\n                <el-button type=\"primary\" @click=\"onSubmit\">提交</el-button>\r\n            </el-form-item>\r\n        </el-form>\r\n    </div>\r\n</template>\r\n\r\n<script setup>\r\n    import { reactive, getCurrentInstance, defineProps } from 'vue'\r\n    import { useRouter } from 'vue-router'\r\n    import { ElMessage } from 'element-plus'\r\n    import { Plus } from '@element-plus/icons-vue'\r\n    import { uploadUrl, getAuthHeaders } from '../upload'\r\n\r\n    const { proxy } = getCurrentInstance() // 获取当前实例\r\n\r\n    const router = useRouter() // 获取router\r\n\r\n    // 定义对象变量\r\n    const form = reactive({\r\n        items: []\r\n    })\r\n\r\n    // 指定props变量\r\n    const props = defineProps({\r\n        id: String\r\n    })\r\n\r\n    // 定义获取详情函数\r\n    const fetch = (id) => {\r\n        proxy.$http.get(`rest/ads/${id}`).then((res)=>{\r\n            form.name = res.data.name\r\n            form.items = res.data.items\r\n        })\r\n    }\r\n\r\n    // 定义提交函数\r\n    const onSubmit = () => {\r\n        if (props.id) { // 编辑\r\n            proxy.$http.put(`rest/ads/${props.id}`, form).then(() => {\r\n                router.push('/ads/list')\r\n                ElMessage({\r\n                    message: '操作成功',\r\n                    type: 'success',\r\n                })\r\n            })\r\n        } else { // 新增\r\n            proxy.$http.post('rest/ads', form).then(() => {\r\n                router.push('/ads/list')\r\n                ElMessage({\r\n                    message: '操作成功',\r\n                    type: 'success',\r\n                })\r\n            })\r\n        }\r\n    }\r\n\r\n    // 有id则执行函数\r\n    props.id && fetch(props.id)\r\n</script>\r\n\r\n<style>\r\n    .avatar-uploader .avatar {\r\n        width: 100px;\r\n        height: 100px;\r\n        display: block;\r\n    }\r\n\r\n    .avatar-uploader .el-upload {\r\n        border: 1px dashed var(--el-border-color);\r\n        border-radius: 6px;\r\n        cursor: pointer;\r\n        position: relative;\r\n        overflow: hidden;\r\n        transition: var(--el-transition-duration-fast);\r\n    }\r\n\r\n    .avatar-uploader .el-upload:hover {\r\n        border-color: var(--el-color-primary);\r\n    }\r\n\r\n    .el-icon.avatar-uploader-icon {\r\n        font-size: 28px;\r\n        color: #8c939d;\r\n        width: 100px;\r\n        height: 100px;\r\n        text-align: center;\r\n    }\r\n</style>\r\n","import script from \"./AdEdit.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./AdEdit.vue?vue&type=script&setup=true&lang=js\"\n\nimport \"./AdEdit.vue?vue&type=style&index=0&id=06202d78&lang=css\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["uploadUrl","http","getAuthHeaders","Authorization","localStorage","token","proxy","getCurrentInstance","router","useRouter","form","reactive","items","fetch","id","$http","get","then","res","name","data","onSubmit","props","put","push","ElMessage","message","type","post","__exports__"],"sourceRoot":""}